<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUIZ FOR CSS ASPIRANTS 26 APRIL 2025 - SYED ASGHAR ALI SHAH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Apply Inter font globally */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Standard syntax */
            /* Disable image dragging */
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
        }
        /* Custom styles for quiz elements */
        .quiz-option {
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
        }
        .quiz-option:hover {
            background-color: #e0f2fe; /* Light blue hover */
            border-color: #3b82f6; /* Blue border hover */
        }
        .quiz-option.selected {
            background-color: #bfdbfe; /* Darker blue selected */
            border-color: #2563eb; /* Darker blue border selected */
            font-weight: 600;
        }
        /* Style for correct/incorrect feedback (optional, can be added on submit) */
        .quiz-option.correct {
            background-color: #dcfce7;
            border-color: #22c55e;
        }
        .quiz-option.incorrect {
            background-color: #fee2e2;
            border-color: #ef4444;
        }
        /* Hide scrollbar but allow scrolling */
         .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        /* Prevent image saving */
        img {
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-100 to-blue-100 min-h-screen flex flex-col" oncontextmenu="return false;">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex flex-col sm:flex-row justify-between items-center">
            <div class="flex items-center space-x-3 mb-2 sm:mb-0">
                 <img src="https://media-hosting.imagekit.io//0b9a4af30efb4482/WhatsApp%20Image%202025-02-28%20at%203.15.19%20AM.jpeg?Expires=1835349432&Key-Pair-Id=K2ZIVPTIP2VGHC&Signature=jwJPYv24ynvpiPUADnh2kUGPUbG6OBggLpvXOj6~ZZAgts7lamWPTIZKmuIaQ5WaRUAG568acIjSbBE1XrKsIPvCHTXKNA-XF6ppaM~tacD0TMTVoTFd7-EsYFsesMaR~5AK7n5qr33hIwKVawluJ1rkdqmuQokM~T~W~O~6Yo-qXgYGio2IvfBsu1u~wEi1Cnk-5pAOavMUb9IfeY7E4FNwGBgiLCiHugKJD9sAY8As7S0szpehWI8WIQzMzNUFN4wvtPAamSART1m5nlUT4uLcvwdr-C1pk4kJN6I0itWzZEbZN04ANZexY3dpBhUDO0~UvQBCps64LPKIQBRYtA__"
                     alt="User Image"
                     class="h-12 w-12 rounded-full object-cover border-2 border-blue-500"
                     onerror="this.onerror=null; this.src='https://placehold.co/48x48/007bff/ffffff?text=SA';">
                 <span class="text-lg font-semibold text-gray-700">SYED ASGHAR ALI SHAH</span>
            </div>
            <h1 class="text-xl sm:text-2xl font-bold text-center text-blue-700">QUIZ FOR CSS ASPIRANTS 26 APRIL 2025</h1>
            <div id="timer-display" class="text-lg sm:text-xl font-semibold text-red-600 mt-2 sm:mt-0">Time Left: 25:00</div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 flex-grow">

        <section id="name-entry" class="max-w-lg mx-auto bg-white p-6 sm:p-8 rounded-lg shadow-lg text-center">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">Welcome to the Grammar Challenge!</h2>
            <p class="text-gray-600 mb-6">Please enter your full name to begin the quiz.</p>
            <input type="text" id="student-name" placeholder="Enter your full name" class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 mb-6 text-lg" required>
            <button id="start-quiz-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-md text-lg transition duration-300 ease-in-out transform hover:scale-105">
                Start Quiz
            </button>
        </section>

        <section id="quiz-section" class="hidden max-w-4xl mx-auto bg-white p-6 sm:p-8 rounded-lg shadow-xl">
            <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Grammar & Vocabulary Quiz</h2>
            <div id="question-container" class="mb-6">
                <p class="text-lg font-semibold text-gray-700 mb-2"><span id="question-number"></span> / 50</p>
                <p id="question-text" class="text-xl text-gray-800 mb-5 leading-relaxed"></p>
                <div id="options-container" class="space-y-3">
                    </div>
                 <div id="rearrangement-input-container" class="hidden mt-4">
                    <label for="rearrangement-answer" class="block text-gray-700 font-medium mb-2">Your Rearranged Sentence:</label>
                    <input type="text" id="rearrangement-answer" placeholder="Type the rearranged sentence here" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
            <div class="flex justify-between items-center mt-8">
                 <button id="prev-question-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-5 rounded-md transition duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed">
                    Previous
                </button>
                <button id="next-question-btn" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-5 rounded-md transition duration-300 ease-in-out">
                    Next
                </button>
                <button id="submit-quiz-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-md transition duration-300 ease-in-out hidden">
                    Submit Quiz
                </button>
            </div>
        </section>

        <section id="results-section" class="hidden max-w-lg mx-auto bg-white p-6 sm:p-8 rounded-lg shadow-lg text-center mt-10">
            <h2 class="text-3xl font-bold mb-6 text-blue-700">Quiz Results</h2>
            <div class="space-y-4 text-lg text-gray-700">
                <p><strong class="font-semibold text-gray-800">Name:</strong> <span id="result-name"></span></p>
                <p><strong class="font-semibold text-gray-800">Time Taken:</strong> <span id="result-time"></span></p>
                <p><strong class="font-semibold text-gray-800">Questions Attempted:</strong> <span id="result-attempted"></span></p>
                <p><strong class="font-semibold text-gray-800">Correct Answers:</strong> <span id="result-score"></span> / 50</p>
                <p><strong class="font-semibold text-gray-800">Percentage:</strong> <span id="result-percentage"></span>%</p>
            </div>
             <p class="mt-6 text-sm text-gray-500">Your results have been submitted. Thank you for participating!</p>
        </section>

        <form id="results-form" action="https://formspree.io/f/xwpvddea" method="POST" class="hidden">
            <input type="text" name="name" id="form-name">
            <input type="text" name="time_taken" id="form-time">
            <input type="number" name="attempted" id="form-attempted">
            <input type="number" name="score" id="form-score">
            <input type="text" name="percentage" id="form-percentage">
            <input type="hidden" name="_subject" value="New Quiz Submission - CSS Aspirants">
             <input type="text" name="_gotcha" style="display:none"> </form>

    </main>

    <footer class="bg-gray-800 text-white py-6 mt-12 shadow-inner">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">Need assistance or have questions?</p>
            <p class="mb-4 font-semibold text-lg">Contact: 03265762698</p>
            <p class="text-sm text-gray-400">&copy; 2025 SYED ASGHAR ALI SHAH - CSS Aspirant Resources. All rights reserved.</p>
             <p class="text-sm text-gray-500 mt-2">Designed for dedicated CSS Aspirants.</p>
        </div>
    </footer>

    <script>
        // --- Quiz Data (Derived from PDFs) ---
        const quizData = [
            // --- Part of Speech Questions ---
            {
                question: "In the sentence 'This past month, India has been hit by 10 per cent tariffs on goods it ships to the US.', what part of speech is 'tariffs'?",
                options: ["Verb", "Adjective", "Noun", "Adverb"],
                answer: "Noun",
                type: "mcq"
            },
            {
                question: "Identify the part of speech for 'irked' in 'President Donald Trump is irked by this...'.",
                options: ["Noun", "Verb (Past Participle used as Adjective)", "Adverb", "Preposition"],
                answer: "Verb (Past Participle used as Adjective)",
                type: "mcq" // Technically a predicate adjective here
            },
            {
                question: "What part of speech is 'modernise' in '...efforts to modernise its air fleet.'?",
                options: ["Noun", "Adjective", "Verb (Infinitive)", "Adverb"],
                answer: "Verb (Infinitive)",
                type: "mcq"
            },
            {
                question: "In 'Vance welcomed the idea of India buying energy from the US.', 'buying' functions as a:",
                options: ["Present Participle (Adjective)", "Gerund (Noun)", "Main Verb", "Adverb"],
                answer: "Gerund (Noun)",
                type: "mcq" // Gerund as object of the preposition 'of'
            },
            {
                question: "What is the part of speech for 'however' in 'India's trade war with the US, however, seems to augur only uncertainty...'?",
                options: ["Conjunction (Coordinating)", "Adjective", "Preposition", "Adverb (Conjunctive/Transitional)"],
                answer: "Adverb (Conjunctive/Transitional)",
                type: "mcq"
            },
             {
                question: "Identify the pronoun type for 'it' in '...goods it ships to the US.'",
                options: ["Personal (Subjective)", "Personal (Objective)", "Possessive", "Reflexive"],
                answer: "Personal (Subjective)", // 'it' is the subject of the verb 'ships' in the implied relative clause "that it ships"
                type: "mcq"
            },
            {
                question: "What part of speech is 'unfortunate' in 'The tension between India and Pakistan is unfortunate...'?",
                options: ["Adverb", "Noun", "Verb", "Adjective (Predicate)"],
                answer: "Adjective (Predicate)",
                type: "mcq"
            },
             {
                question: "In the phrase '...arguably bigger war...', what does 'arguably' modify?",
                options: ["war (Noun)", "bigger (Adjective)", "fighting (Verb)", "is (Verb)"],
                answer: "bigger (Adjective)",
                type: "mcq"
            },
             {
                question: "What type of verb is 'seems' in '...seems to augur only uncertainty...'?",
                options: ["Action Verb", "Helping Verb", "Linking Verb", "Modal Verb"],
                answer: "Linking Verb",
                type: "mcq"
            },
            {
                question: "Identify the part of speech for 'between' in '...escalation of tensions between Pakistan and India...'.",
                options: ["Adverb", "Conjunction", "Preposition", "Adjective"],
                answer: "Preposition",
                type: "mcq"
            },
            // --- Preposition Questions ---
            {
                question: "Choose the correct preposition: 'The US is India's largest trading partner, with exports ____ it accounting for 18pc...'",
                options: ["on", "to", "from", "by"],
                answer: "to",
                type: "mcq"
            },
            {
                question: "Fill in the blank: 'Concerns have been raised ____ the effectiveness of the F-35...'",
                options: ["about", "regarding", "over", "with"],
                answer: "regarding", // 'about' or 'over' could also fit, but 'regarding' is used in the text.
                type: "mcq"
            },
            {
                question: "Select the appropriate preposition: 'Vance welcomed the idea ____ India buying energy from the US.'",
                options: ["for", "with", "of", "about"],
                answer: "of",
                type: "mcq"
            },
            {
                question: "Complete the sentence: 'Reading ____ the lines of the Vance visit shows how far apart the two countries are.'",
                options: ["in", "between", "through", "over"],
                answer: "between",
                type: "mcq"
            },
             {
                question: "Which preposition fits here: '...strike a deal that is ____ America’s liking...'?",
                options: ["for", "with", "to", "by"],
                answer: "to",
                type: "mcq"
            },
            // --- Verb Tense/Aspect/Voice/Mood Questions ---
            {
                question: "What is the tense and voice of 'has been hit' in 'India has been hit by 10 per cent tariffs'?",
                options: ["Present Perfect Active", "Past Perfect Passive", "Present Perfect Passive", "Simple Present Passive"],
                answer: "Present Perfect Passive",
                type: "mcq"
            },
            {
                question: "Identify the tense of 'had brought' in '...how the South Koreans had brought their A-game...'.",
                options: ["Simple Past", "Past Continuous", "Present Perfect", "Past Perfect"],
                answer: "Past Perfect",
                type: "mcq"
            },
            {
                question: "What mood is predominantly used in the sentence 'The US is India’s largest trading partner.'?",
                options: ["Indicative", "Imperative", "Subjunctive", "Conditional"],
                answer: "Indicative",
                type: "mcq"
            },
            {
                question: "The verb phrase 'could be produced' in '...which Russia has proposed could be produced within India.' expresses:",
                options: ["Certainty", "Obligation", "Possibility/Capability", "Past Habit"],
                answer: "Possibility/Capability",
                type: "mcq"
            },
             {
                question: "Is the main clause 'New Delhi is already fighting an arguably bigger war' in Active or Passive voice?",
                options: ["Active", "Passive"],
                answer: "Active",
                type: "mcq"
            },
            // --- Sentence Structure Questions ---
            {
                question: "Classify the sentence: 'President Donald Trump is irked by this.'",
                options: ["Simple", "Compound", "Complex", "Compound-Complex"],
                answer: "Simple",
                type: "mcq"
            },
            {
                question: "What type of sentence is: 'This ‘deal’ sounds good in theory but presents problems for Modi’s domestic initiatives.'?",
                options: ["Simple", "Compound", "Complex", "Compound-Complex"],
                answer: "Compound", // Two independent clauses joined by 'but'
                type: "mcq"
            },
            {
                question: "Identify the sentence type: 'WHILE the tragic attack...may have increased the prospects of war..., New Delhi is already fighting an arguably bigger war...'",
                options: ["Simple", "Compound", "Complex", "Compound-Complex"],
                answer: "Complex", // Dependent clause (starting with WHILE) + Independent clause
                type: "mcq"
            },
            {
                question: "What kind of clause is 'that is to America’s liking' in '...strike a deal that is to America’s liking...'?",
                options: ["Independent Clause", "Adverbial Clause", "Noun Clause", "Adjectival (Relative) Clause"],
                answer: "Adjectival (Relative) Clause", // Modifies 'deal'
                type: "mcq"
            },
             {
                question: "The clause 'how the world is coming to America' functions as what in the sentence '...has been eager to boast of how the world is coming to America...'?",
                options: ["Adjective Clause", "Adverb Clause", "Noun Clause (Object of Preposition)", "Independent Clause"],
                answer: "Noun Clause (Object of Preposition)", // Object of 'of'
                type: "mcq"
            },
            // --- Idioms, Synonyms, Antonyms Questions ---
            {
                question: "What is the meaning of the idiom 'Upped the ante'?",
                options: ["Reduced the demands", "Increased the demands or risks", "Kept things the same", "Offered a compromise"],
                answer: "Increased the demands or risks",
                type: "mcq"
            },
            {
                question: "Which is a synonym for 'In abeyance'?",
                options: ["Active", "Resumed", "Suspended", "Ongoing"],
                answer: "Suspended",
                type: "mcq"
            },
            {
                question: "Choose the antonym for 'Give diplomacy a chance'.",
                options: ["Attempt negotiation", "Seek peaceful resolution", "Resort to force", "Try talking"],
                answer: "Resort to force",
                type: "mcq"
            },
            {
                question: "The idiom 'Scapegoat' refers to:",
                options: ["The real culprit", "A person blamed for others' mistakes", "A hero", "A leader"],
                answer: "A person blamed for others' mistakes",
                type: "mcq"
            },
            {
                question: "What does 'Fanning the flames' mean?",
                options: ["Calming a situation", "Making a situation worse", "Ignoring a problem", "Starting a fire"],
                answer: "Making a situation worse",
                type: "mcq"
            },
             {
                question: "An antonym for 'Bring down the temperature' (reduce tension) is:",
                options: ["Cool things down", "De-escalate", "Calm the situation", "Inflame"],
                answer: "Inflame",
                type: "mcq"
            },
             {
                question: "What does 'Left a bad taste in the mouth' signify?",
                options: ["A pleasant feeling", "A feeling of displeasure or bitterness", "A delicious meal", "A neutral experience"],
                answer: "A feeling of displeasure or bitterness",
                type: "mcq"
            },
             {
                question: "Which phrase means 'To escape from or evade authorities'?",
                options: ["Take action against", "Give authorities the slip", "Besmirch image", "Follow up"],
                answer: "Give authorities the slip",
                type: "mcq"
            },
             {
                question: "A 'Precision strike' is best described as:",
                options: ["Indiscriminate bombing", "Carpet bombing", "A targeted attack", "A ground assault"],
                answer: "A targeted attack",
                type: "mcq"
            },
            {
                question: "What is the meaning of 'Rubber-stamped'?",
                options: ["Scrutinized carefully", "Rejected after review", "Approved automatically without proper consideration", "Questioned intensely"],
                answer: "Approved automatically without proper consideration",
                type: "mcq"
            },
            {
                question: "Choose a synonym for 'Held to account'.",
                options: ["Excused", "Pardoned", "Let off", "Held responsible"],
                answer: "Held responsible",
                type: "mcq"
            },
            {
                question: "The idiom 'Gain traction' means:",
                options: ["Lose support", "Stagnate", "Become popular or accepted", "Fade away"],
                answer: "Become popular or accepted",
                type: "mcq"
            },
            {
                question: "What is an antonym for 'Rule by fear'?",
                options: ["Intimidation", "Tyranny", "Rule of law", "Despotism"],
                answer: "Rule of law",
                type: "mcq"
            },
            {
                question: "The phrase 'Race to the bottom' describes a situation where standards are:",
                options: ["Raised", "Lowered competitively", "Maintained", "Ignored"],
                answer: "Lowered competitively",
                type: "mcq"
            },
             {
                question: "'Follow suit' means:",
                options: ["Act independently", "Innovate", "Do the same as someone else", "Diverge"],
                answer: "Do the same as someone else",
                type: "mcq"
            },
             {
                question: "What does 'Dare to differ' imply?",
                options: ["Conforming", "Agreeing", "Having the courage to disagree", "Remaining silent"],
                answer: "Having the courage to disagree",
                type: "mcq"
            },
             {
                question: "A 'Puppet regime' is a government that is:",
                options: ["Sovereign and independent", "Actually controlled by an outside power", "Elected democratically", "Autonomous"],
                answer: "Actually controlled by an outside power",
                type: "mcq"
            },
             {
                question: "What does 'Sorely lacking' mean?",
                options: ["Abundant", "Sufficient", "Very much needed but absent/insufficient", "Adequate"],
                answer: "Very much needed but absent/insufficient",
                type: "mcq"
            },
            {
                question: "An antonym for 'Cash-strapped' is:",
                options: ["Impoverished", "Broke", "Underfunded", "Affluent"],
                answer: "Affluent",
                type: "mcq"
            },
             {
                question: "'Uncharted territory' refers to something:",
                options: ["Familiar and known", "Well-trodden", "New, unknown, or unexplored", "Established"],
                answer: "New, unknown, or unexplored",
                type: "mcq"
            },

            // --- Sentence Rearrangement Questions ---
            {
                question: "Rearrange the following parts into a grammatically correct and meaningful sentence: (A) has been hit / (B) by 10 per cent tariffs / (C) India / (D) this past month / (E) on goods it ships to the US",
                options: ["D A C B E", "C A D B E", "D C A B E", "C D A B E"], // Correct order: D, C, A, B, E
                answer: "D C A B E", // This past month, India has been hit by 10 per cent tariffs on goods it ships to the US.
                type: "rearrangement_mcq", // Using MCQ format for rearrangement
                parts: { "A": "has been hit", "B": "by 10 per cent tariffs", "C": "India", "D": "this past month", "E": "on goods it ships to the US" }
            },
             {
                question: "Rearrange the jumbled parts to form a coherent sentence: (A) the flames / (B) instead of / (C) need to calm down / (D) fanning / (E) they",
                options: ["B D A E C", "E B D A C", "E C B D A", "B D E A C"], // Correct order: B, D, A, E, C
                answer: "B D A E C", // Instead of fanning the flames, they need to calm down.
                type: "rearrangement_mcq",
                parts: { "A": "the flames", "B": "instead of", "C": "need to calm down", "D": "fanning", "E": "they" }
            },
            {
                question: "Arrange these parts into a logical sentence: (A) has captured / (B) Mahrang Baloch / (C) the imagination / (D) of the Baloch sub-nation",
                options: ["B A C D", "A B C D", "B C A D", "C B A D"], // Correct order: B, A, C, D
                answer: "B A C D", // Mahrang Baloch has captured the imagination of the Baloch sub-nation.
                type: "rearrangement_mcq",
                parts: { "A": "has captured", "B": "Mahrang Baloch", "C": "the imagination", "D": "of the Baloch sub-nation" }
            },
            {
                question: "Form a correct sentence from these parts: (A) must mend / (B) to gain trust / (C) its behaviour / (D) the state",
                options: ["D C A B", "D A C B", "A D C B", "B D A C"], // Correct order: D, A, C, B
                answer: "D A C B", // The state must mend its behaviour to gain trust.
                type: "rearrangement_mcq",
                parts: { "A": "must mend", "B": "to gain trust", "C": "its behaviour", "D": "the state" }
            },
             {
                question: "Rearrange the following to make a meaningful sentence: (A) are the / (B) political stability / (C) foremost need / (D) and legitimacy / (E) of the hour",
                options: ["B D A C E", "B A D C E", "C E A B D", "A C E B D"], // Correct order: B, D, A, C, E
                answer: "B D A C E", // Political stability and legitimacy are the foremost need of the hour.
                type: "rearrangement_mcq",
                parts: { "A": "are the", "B": "political stability", "C": "foremost need", "D": "and legitimacy", "E": "of the hour" }
            }
        ];

        // --- DOM Elements ---
        const nameEntrySection = document.getElementById('name-entry');
        const quizSection = document.getElementById('quiz-section');
        const resultsSection = document.getElementById('results-section');
        const studentNameInput = document.getElementById('student-name');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const questionContainer = document.getElementById('question-container');
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const rearrangementInputContainer = document.getElementById('rearrangement-input-container');
        const rearrangementAnswerInput = document.getElementById('rearrangement-answer');
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const prevQuestionBtn = document.getElementById('prev-question-btn');
        const submitQuizBtn = document.getElementById('submit-quiz-btn');
        const timerDisplay = document.getElementById('timer-display');
        const resultNameEl = document.getElementById('result-name');
        const resultTimeEl = document.getElementById('result-time');
        const resultAttemptedEl = document.getElementById('result-attempted');
        const resultScoreEl = document.getElementById('result-score');
        const resultPercentageEl = document.getElementById('result-percentage');
        const resultsForm = document.getElementById('results-form');
        const formName = document.getElementById('form-name');
        const formTime = document.getElementById('form-time');
        const formAttempted = document.getElementById('form-attempted');
        const formScore = document.getElementById('form-score');
        const formPercentage = document.getElementById('form-percentage');

        // --- Quiz State ---
        let currentQuestionIndex = 0;
        let userAnswers = new Array(quizData.length).fill(null);
        let score = 0;
        let timerInterval;
        let timeLeft = 25 * 60; // 25 minutes in seconds
        let startTime;
        let endTime;
        let studentName = '';

        // --- Utility Functions ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
        }

        // Shuffle options for each MCQ question
        quizData.forEach(q => {
            if (q.type === 'mcq' || q.type === 'rearrangement_mcq') {
                 // Keep track of the original answer before shuffling options
                const correctAnswerValue = q.answer;
                // Find the option text that matches the answer value for rearrangement_mcq
                const correctAnswerText = (q.type === 'rearrangement_mcq')
                    ? q.options.find(opt => opt === correctAnswerValue) // The answer is the key sequence
                    : correctAnswerValue; // For MCQ, the answer is the option text

                shuffleArray(q.options);

                 // Update the answer to match the potentially new index/value after shuffling
                 // For MCQ, the answer remains the text content.
                 // For rearrangement_mcq, the answer remains the key sequence string.
                 q.answer = correctAnswerValue;
            }
        });

        // --- Event Listeners ---
        startQuizBtn.addEventListener('click', startQuiz);
        nextQuestionBtn.addEventListener('click', nextQuestion);
        prevQuestionBtn.addEventListener('click', prevQuestion);
        submitQuizBtn.addEventListener('click', submitQuiz);

        // Prevent context menu (right-click)
        document.addEventListener('contextmenu', event => event.preventDefault());

        // Optional: Disable specific keys like F12 (Inspect Element)
        document.addEventListener('keydown', event => {
            if (event.key === 'F12' || (event.ctrlKey && event.shiftKey && event.key === 'I') || (event.ctrlKey && event.shiftKey && event.key === 'J') || (event.ctrlKey && event.key === 'U')) {
                event.preventDefault();
            }
        });


        // --- Quiz Logic ---
        function startQuiz() {
            studentName = studentNameInput.value.trim();
            if (studentName === "") {
                alert("Please enter your name to start the quiz.");
                return;
            }
            nameEntrySection.classList.add('hidden');
            quizSection.classList.remove('hidden');
            startTime = new Date();
            startTimer();
            displayQuestion(currentQuestionIndex);
            updateNavigationButtons(); // Initial button state
        }

        function displayQuestion(index) {
            const question = quizData[index];
            questionNumberEl.textContent = index + 1;
            questionTextEl.textContent = question.question;
            optionsContainer.innerHTML = ''; // Clear previous options
            rearrangementInputContainer.classList.add('hidden'); // Hide rearrangement input by default
            rearrangementAnswerInput.value = ''; // Clear previous rearrangement answer

            if (question.type === 'mcq' || question.type === 'rearrangement_mcq') {
                // Display parts for rearrangement questions
                if (question.type === 'rearrangement_mcq' && question.parts) {
                    let partsHtml = '<div class="mt-4 p-3 bg-gray-100 rounded border border-gray-300 text-sm">';
                    partsHtml += '<p class="font-medium mb-2 text-gray-700">Parts:</p><ul class="list-disc list-inside">';
                    for (const key in question.parts) {
                        partsHtml += `<li><strong>(${key})</strong> ${question.parts[key]}</li>`;
                    }
                    partsHtml += '</ul></div>';
                    questionTextEl.insertAdjacentHTML('afterend', partsHtml);
                }

                // Display options
                question.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.classList.add('block', 'w-full', 'text-left', 'p-3', 'border', 'border-gray-300', 'rounded-md', 'quiz-option', 'text-gray-700', 'hover:bg-blue-100', 'hover:border-blue-400');
                    button.onclick = () => selectAnswer(index, option, button);

                    // If an answer was previously selected for this question, highlight it
                    if (userAnswers[index] === option) {
                        button.classList.add('selected');
                    }
                    optionsContainer.appendChild(button);
                });
            }
            // Note: No separate handling needed for rearrangement input here,
            // as we are using MCQ options to select the correct sequence.
            // If free-form rearrangement input was needed, we'd show rearrangementInputContainer.

            updateNavigationButtons();
        }


        function selectAnswer(index, answer, selectedButton) {
            // Deselect previously selected option for this question
            const previouslySelected = optionsContainer.querySelector('.selected');
            if (previouslySelected) {
                previouslySelected.classList.remove('selected');
            }

            // Select the new option
            selectedButton.classList.add('selected');
            userAnswers[index] = answer; // Store the selected option value/text

            // Automatically move to the next question after a brief delay (optional)
            // setTimeout(nextQuestion, 300);
        }


        function updateNavigationButtons() {
            prevQuestionBtn.disabled = currentQuestionIndex === 0;
            if (currentQuestionIndex === quizData.length - 1) {
                nextQuestionBtn.classList.add('hidden');
                submitQuizBtn.classList.remove('hidden');
            } else {
                nextQuestionBtn.classList.remove('hidden');
                submitQuizBtn.classList.add('hidden');
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                displayQuestion(currentQuestionIndex);
            }
        }

        function prevQuestion() {
             if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion(currentQuestionIndex);
            }
        }


        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `Time Left: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert("Time's up! Submitting your quiz automatically.");
                    submitQuiz();
                }
            }, 1000);
        }

        function submitQuiz() {
            clearInterval(timerInterval); // Stop the timer
            endTime = new Date();

            calculateResults();

            quizSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            timerDisplay.classList.add('hidden'); // Hide timer on results page

            // Populate and submit the hidden form
            populateAndSubmitForm();
        }

        function calculateResults() {
            score = 0;
            let attemptedCount = 0;
            quizData.forEach((question, index) => {
                if (userAnswers[index] !== null) {
                    attemptedCount++;
                    // Check if the stored answer matches the correct answer text/value
                    if (userAnswers[index] === question.answer) {
                        score++;
                    }
                }
            });

            const timeTaken = Math.round((endTime - startTime) / 1000); // Time in seconds
            const minutesTaken = Math.floor(timeTaken / 60);
            const secondsTaken = timeTaken % 60;
            const timeTakenFormatted = `${minutesTaken} min ${secondsTaken} sec`;
            const percentage = ((score / quizData.length) * 100).toFixed(1);

            // Display results
            resultNameEl.textContent = studentName;
            resultTimeEl.textContent = timeTakenFormatted;
            resultAttemptedEl.textContent = attemptedCount;
            resultScoreEl.textContent = score;
            resultPercentageEl.textContent = percentage;

            // Store for form submission
             formName.value = studentName;
             formTime.value = timeTakenFormatted;
             formAttempted.value = attemptedCount;
             formScore.value = score;
             formPercentage.value = percentage;
        }

         function populateAndSubmitForm() {
            // Values are already set in calculateResults()
            resultsForm.submit();
            console.log("Submitting form to Formspree..."); // For debugging
        }

    </script>

</body>
</html>
